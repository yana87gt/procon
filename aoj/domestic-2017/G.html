<script type="text/x-mathjax-config">
	MathJax.Hub.Config({ tex2jax: { inlineMath: [["$","$"], ["\\(","\\)"]], processEscapes: true }});
</script>
<script type="text/javascript"
	src="http://acm-icpc.aitea.net/files/mathjax/MathJax.js?config=TeX-AMS_HTML">
</script>
<meta http-equiv="X-UA-Compatible" CONTENT="IE=EmulateIE7" />
<!-- begin ja only -->
<h3><u>へやわり！</u></h3>
<!-- end ja only -->
<div>
<!-- begin en only -->
<p>
English text is not available in this practice contest.
</p>
<!-- end en only -->
<!-- begin ja only -->
<p><i>N+1</i> 部屋が1列に並んだ新築の建物がある．各部屋はすべて1人用の住居であり，現在どの部屋も空室だが，来月から新たに <i>N</i> 人がここに住む予定である．したがって彼らが暮らし始めると1室は空き部屋になる．
</p><pre></pre><p>あなたは大家として，彼らの嗜好に合わせた部屋割りを多く提案したいと考えている．ここで部屋割りとは，それぞれの人がどの部屋に住むのかを与える表である．例えば <i>N = 3</i> のとき，「1人目は4号室，2人目は1号室，3人目は2号室」がありうる一つの部屋割りである．
</p><pre></pre><p>もちろん，ありうるすべての部屋割りを提案すれば話は早いが，それでは提案の意味がないため，大家の手間と住人の嗜好を考慮していくつか制約を設ける．
</p><pre></pre><p>まず，提案された部屋割りの一つに彼らが住み始めてから，「別の提案された部屋割りの方に変更したい」と言われるかもしれない．この建物は新築であり，彼らはまだ誰も入居していない新しい部屋が好みであることがわかっているので，単純に誰か1人が空き部屋へ引っ越しをするだけで提案された別の部屋割りに変更できるときに限りこれが起こりうる．しかし大家として，そういう面倒ごとは避けたいため，このような変更が許されないよう，提案する部屋割りをうまく調整したい．
つまり，提案する部屋割りの集合は次を満たさなければならない．
「任意の二つの異なる提案された部屋割り <i>A, B</i> に対して，部屋割り <i>A</i> の空き部屋に誰か1人を移しても部屋割り <i>B</i> にならない」
</p><pre></pre><p>次に，これから住む <i>N</i> 人にはそれぞれちょうど1人好ましい人がいることがわかっている．したがって，提案するすべての部屋割りは，すべての人に対して好ましい人が隣に住むような部屋割りにする．
</p><pre></pre><p>これらの条件を満たす部屋割りの集合で，最大の集合の大きさはいくらだろうか？<i>1,</sub>000,</sub>000,</sub>007</i> で割った余りを求めてほしい．
</p><pre></pre>

<!-- end ja only -->
</div>
<h3>Input</h3>
<div>
<!-- begin ja only -->
<p>入力は複数のデータセットからなる．
各データセットは次の形式で表される．
</p><blockquote><i>N</i><br><i>a<sub>1</sub></i> <i>a<sub>2</sub> ... a<sub>N</sub></i><br></blockquote>
<p>データセットの 1 行目には，来月建物に住む人数を表す整数 <i>N</i> が与えられる．これは <i>2 &le; N &le; 100,</sub>000</i> を満たす．
2行目には <i>i</i> 番目の人にとって隣の部屋に住んでくれると好ましい人の番号 <i>a<sub>i</sub></i> の情報が与えられる．これについては <i>1 &le; a<sub>i</sub> &le; N</i> かつ <i>a<sub>i</sub> &ne; i</i> を満たす．
また，データセットの数は 50 を超えない．
入力の終わりは，1個のゼロだけからなる行で表される．
</p><blockquote></blockquote>


<!-- end ja only -->
</div>
<h3>Output</h3>
<div>
<!-- begin ja only -->
<p>各データセットに対して，問題文にあるような，同時に提案できる部屋割りの数の最大値を，<i>1,</sub>000,</sub>000,</sub>007</i> で割った余りを1行で出力せよ．
</p>




<!-- end ja only -->
</div>
<h3>Sample Input</h3>
<div>
<pre>2
2 1
3
3 1 2
10
2 1 1 1 1 1 1 1 1 1
8
2 1 4 3 3 7 6 6
25
2 3 2 5 4 5 8 7 8 11 10 13 12 15 14 17 16 19 18 21 20 23 22 25 24
10
2 1 4 3 6 5 8 7 10 9
0

</pre>

</div><h3>Output for Sample Input</h3>
<div>
<pre>2
0
0
144
633544712
11520


</pre>

</div></div>
